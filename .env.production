# ===========================================
# CONFIGURATION DE PRODUCTION - AUTH SERVICE
# ===========================================

# Application
NODE_ENV=production
PORT=3000

# ===========================================
# BASE DE DONNÉES POSTGRESQL
# ===========================================
# Utiliser des variables d'environnement sécurisées en production
DB_HOST=${DB_HOST}
DB_PORT=${DB_PORT:-5432}
DB_USERNAME=${DB_USERNAME}
DB_PASSWORD=${DB_PASSWORD}
DB_NAME=${DB_NAME}

# Pool de connexions optimisé pour la production
DB_MAX_CONNECTIONS=20
DB_MIN_CONNECTIONS=5
DB_IDLE_TIMEOUT=30000
DB_CONNECTION_TIMEOUT=10000

# ===========================================
# REDIS CACHE
# ===========================================
REDIS_HOST=${REDIS_HOST}
REDIS_PORT=${REDIS_PORT:-6379}
REDIS_PASSWORD=${REDIS_PASSWORD}
REDIS_DB=0

# Configuration Redis pour la production
REDIS_MAX_RETRIES=3
REDIS_RETRY_DELAY=1000
REDIS_CONNECT_TIMEOUT=10000
REDIS_COMMAND_TIMEOUT=5000

# ===========================================
# CONFIGURATION JWT
# ===========================================
# Clés EC256 pour la production (à générer de manière sécurisée)
JWT_PRIVATE_KEY=${JWT_PRIVATE_KEY}
JWT_PUBLIC_KEY=${JWT_PUBLIC_KEY}

# Durées de vie des tokens optimisées pour la production
JWT_ACCESS_TOKEN_EXPIRY=15m
JWT_REFRESH_TOKEN_EXPIRY=7d

# ===========================================
# CONFIGURATION SMS
# ===========================================
SMS_PROVIDER=${SMS_PROVIDER:-twilio}
SMS_API_KEY=${SMS_API_KEY}
SMS_API_SECRET=${SMS_API_SECRET}
SMS_FROM_NUMBER=${SMS_FROM_NUMBER}

# Limites SMS pour éviter les abus
SMS_RATE_LIMIT_PER_PHONE=5
SMS_RATE_LIMIT_WINDOW=3600000

# ===========================================
# SÉCURITÉ ET RATE LIMITING
# ===========================================
# Rate limiting strict pour la production
RATE_LIMIT_TTL=60000
RATE_LIMIT_MAX=5

# Rate limiting spécifique par endpoint
LOGIN_RATE_LIMIT_MAX=3
REGISTER_RATE_LIMIT_MAX=2
SMS_RATE_LIMIT_MAX=3

# Sécurité des mots de passe
BCRYPT_ROUNDS=14
MAX_LOGIN_ATTEMPTS=3
LOCKOUT_TIME=1800000

# ===========================================
# AUTHENTIFICATION À DEUX FACTEURS
# ===========================================
TWO_FACTOR_ISSUER=${TWO_FACTOR_ISSUER:-AuthService}
TWO_FACTOR_WINDOW=1

# ===========================================
# GESTION DES APPAREILS
# ===========================================
MAX_DEVICES_PER_USER=3
DEVICE_CHALLENGE_EXPIRY=180

# ===========================================
# LOGGING ET MONITORING
# ===========================================
LOG_LEVEL=warn
ENABLE_REQUEST_LOGGING=false
ENABLE_ERROR_STACK_TRACE=false

# ===========================================
# CORS ET SÉCURITÉ WEB
# ===========================================
CORS_ORIGIN=${CORS_ORIGIN}
CORS_CREDENTIALS=true

# Headers de sécurité
HELMET_ENABLED=true
CSP_ENABLED=true

# ===========================================
# HEALTH CHECK ET MONITORING
# ===========================================
HEALTH_CHECK_ENABLED=true
METRICS_ENABLED=true
METRICS_PORT=9090

# ===========================================
# BACKUP ET MAINTENANCE
# ===========================================
BACKUP_CODES_EXPIRY=2592000000
CLEANUP_EXPIRED_TOKENS_INTERVAL=3600000
CLEANUP_OLD_LOGIN_HISTORY_DAYS=90